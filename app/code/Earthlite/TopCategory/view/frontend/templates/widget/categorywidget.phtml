<?php
if ($block->getUser()) {
    $data = $this->getCatalogData();
    $catalogData = $data['catalogData'];
    $mediaBaseUrl = $data['mediaBaseUrl'];
    if (isset($catalogData) && count($catalogData) > 0) {
        ?>
        <h2 class="text-center text-normal">
            <?php echo $block->getTitle() ?>
        </h2>
        <div class="home-cat">
            <?php
            foreach ($catalogData as $key => $cat) {
                ?>
                <div class="col-xs-4 col-sm-4 col-md-3 catalog-category">
                    <a href="<?php echo $block->escapeUrl($cat->getUrl()); ?>">
                        <div class="img-border">
                            <?php
                            $categoryName = str_replace(' ', '-', $cat->getName());
                            $CategoryNameSplChar = preg_replace('/[^A-Za-z0-9\-]/', '', $categoryName);
                            $categoryImageURL = $cat->getImageUrl() ? $cat->getImageUrl(): $this->getViewFileUrl('Earthlite_TopCategory::images/image_not_available.png');
                            
                            // $categoryImageURL = $mediaBaseUrl . "catalog/category/" . strtolower(str_replace('--', '-', $CategoryNameSplChar)) . ".jpg";
                            ?>
                            <img src="<?php echo $block->escapeUrl($categoryImageURL); ?>?format=A_68" alt="<?php echo $block->escapeHtml($cat->getName()); ?>" />
                        </div>
                        <strong class="cat-name"><?php echo $block->escapeHtml($cat->getName()); ?></strong>
                    </a>
                </div>
                <?php
            }
            ?>
        </div>
        <?php
    }
}
?>
