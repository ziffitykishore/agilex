<?xml version="1.0"?>
<config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="urn:magento:module:Magento_Config:etc/system_file.xsd">
    <system>
        <section id="xtsavedcc" translate="label" sortOrder="153" showInDefault="1" showInStore="1" showInWebsite="1">
            <tab>xtento</tab>
            <label>Saved Credit Cards</label>
            <resource>Xtento_SavedCc::configuration</resource>
            <group id="general" translate="label" showInDefault="1" showInWebsite="0" showInStore="0" sortOrder="10">
                <label>Extension Configuration</label>
                <attribute type="expanded">1</attribute>
                <frontend_model>Xtento\XtCore\Block\System\Config\Form\Xtento\Module</frontend_model>
                <fieldset_css>Xtento_SavedCc|Xtento\SavedCc\Model\System\Config\Backend\Server</fieldset_css>
                <comment>
                    <![CDATA[
                    <script>
                    requirejs(['jquery', 'prototype'], function() {
                        function setCommentHtml(message) {
                            if (Prototype.Browser.IE) {
                                $('xtsavedcc_general_serial').next('p').outerHTML = message;
                            } else {
                                $('xtsavedcc_general_serial').next('p').innerHTML = message;
                            }
                        }

                        function initSystemConfiguration() {
                            if ($('xtsavedcc_general_server_name')) {
                                $('xtsavedcc_general_server_name').style.backgroundColor='#f0f0f0';
                                $('xtsavedcc_general_server_name').disable();
                                if ($('row_xtsavedcc_general_server')) {
                                    $('row_xtsavedcc_general_server').hide();
                                }
                            }

                            if ($('xtsavedcc_general_serial') && $('xtsavedcc_general_serial').value !== '' && $('xtsavedcc_general_server') && $('xtsavedcc_general_server').value !== '') {
                                if ($('xtsavedcc_general_serial').value.length !== 40) {
                                    setCommentHtml('<a href="http://www.xtento.com" target="_blank"><img src="//www.xtento.com/license/check/?d='+$('xtsavedcc_general_server').value+'" border="0" style="margin-top: 4px;"/></a>');
                                } else {
                                    if (typeof $('xtsavedcc_general_serial').nextSibling !== 'undefined' && typeof $('xtsavedcc_general_serial').nextSibling.nextSibling !== 'undefined') {
                                        setCommentHtml('<a href="http://www.xtento.com" target="_blank"><img src="//www.xtento.com/license/check/?d='+$('xtsavedcc_general_server').value+'" border="0" style="margin-top: 4px;"/></a>');
                                    }
                                }
                            } else {
                                if ($('xtsavedcc_general_server').value !== '') {
                                    setCommentHtml('<a href="http://www.xtento.com" target="_blank"><img src="//www.xtento.com/license/check/?d='+$('xtsavedcc_general_server').value+'" border="0" style="margin-top: 4px;"/></a>');
                                }
                            }
                        }
                        jQuery(document).ready(function () {
                            initSystemConfiguration();
                        });
                        jQuery('#xtsavedcc_general_enabled').change(function(){
                            if (jQuery(this).val() == '1') {
                                require([
                                    'Magento_Ui/js/modal/confirm'
                                ], function(confirmation) {
                                    confirmation({
                                        title: 'Warning: Read this before enabling the extension',
                                        content: 'In most countries, storing full credit card information on your server is not permitted unless you are fully PCI certified. It is against PCI standards to keep customer credit card information in your database. Use this extension at your own risk, and be sure to check whether you are allowed to store credit card information yourself or not. This extension was built for environments where storing credit card information is allowed, and we will not take any liability for stores using this extension in production environments where storing credit card information locally is prohibited.',
                                        actions: {
                                            confirm: function(){},
                                            cancel: function(){jQuery('#xtsavedcc_general_enabled').val(0);},
                                            always: function(){}
                                        }
                                    });
                                });
                            }
                        });
                    });
                    </script>
                    ]]>
                </comment>
                <field id="heading" translate="label" sortOrder="10" showInDefault="1">
                    <label>General Configuration</label>
                    <frontend_model>Magento\Config\Block\System\Config\Form\Field\Heading</frontend_model>
                </field>
                <field id="server_name" translate="label" sortOrder="20" showInDefault="1">
                    <label>Server Name</label>
                    <frontend_model>Xtento\XtCore\Block\System\Config\Form\Xtento\Servername</frontend_model>
                </field>
                <field id="serial" translate="label" sortOrder="30" showInDefault="1">
                    <label>License Key</label>
                    <comment>Please enter your license key here.</comment>
                    <backend_model>Xtento\XtCore\Model\System\Config\Backend\License</backend_model>
                </field>
                <field id="enabled" translate="label comment" type="select" sortOrder="40" showInDefault="1">
                    <label>Module Enabled</label>
                    <comment><![CDATA[A valid license key is required in order to enable the module.<br/><br/><strong>Note: Go to Stores &gt; Configuration &gt; Sales &gt; Payment Methods and configure the "Saved Credit Cards" payment method as well.</strong>]]></comment>
                    <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
                </field>
                <field id="server" translate="label" type="hidden" sortOrder="45" showInDefault="1">
                    <label/>
                    <backend_model>Xtento\SavedCc\Model\System\Config\Backend\Server</backend_model>
                </field>
                <field id="misc_heading" translate="label" sortOrder="50" showInDefault="1">
                    <label>Module Configuration</label>
                    <frontend_model>Magento\Config\Block\System\Config\Form\Field\Heading</frontend_model>
                </field>
                <field id="show_cc_info_backend" translate="label comment" type="select" sortOrder="60" showInDefault="1">
                    <label>Show CC Info In Backend</label>
                    <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
                    <comment>If enabled, full credit card information will be shown when viewing an order.</comment>
                </field>
                <field id="show_wipe_button_backend" translate="label comment" type="select" sortOrder="70" showInDefault="1">
                    <label>Show Wipe Button In Backend</label>
                    <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
                    <comment>If enabled, a "Wipe" button will be shown when viewing an order. By clicking it, the credit card information is wiped from the database.</comment>
                </field>
                <field id="show_cc_info_masked" translate="label comment" type="select" sortOrder="75" showInDefault="1">
                    <label>Hide CC Info ("Masked Mode")</label>
                    <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
                    <comment>If enabled, credit card information will be hidden when viewing an order. Clicking "Show" will then show the full credit card information.</comment>
                </field>
                <field id="wipe_cc_after" translate="label comment" type="text" sortOrder="80" showInDefault="1">
                    <label>Wipe CC Information After X Days</label>
                    <comment>Period in days after which credit card information is wiped from orders in the database. If you do not want to remove credit card information automatically, set this to 0. This requires the Magento cronjob to work properly.</comment>
                </field>
            </group>
        </section>
        <section id="payment">
            <group id="xtsavedcc" translate="label" type="text" sortOrder="999" showInDefault="1" showInWebsite="1" showInStore="1">
                <label>Saved Credit Cards</label>
                <field id="active" translate="label" type="select" sortOrder="1" showInDefault="1" showInWebsite="1" showInStore="0">
                    <label>Enabled</label>
                    <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
                </field>
                <field id="order_status" translate="label" type="select" sortOrder="2" showInDefault="1" showInWebsite="1" showInStore="0">
                    <label>New Order Status</label>
                    <source_model>Magento\Sales\Model\Config\Source\Order\Status</source_model>
                </field>
                <field id="title" translate="label" type="text" sortOrder="1" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Title</label>
                </field>
                <field id="cctypes" translate="label" type="multiselect" sortOrder="40" showInDefault="1" showInWebsite="1" showInStore="0">
                    <label>Credit Card Types</label>
                    <source_model>Xtento\SavedCc\Model\System\Config\Source\Cctype</source_model>
                </field>
                <!--<field id="useccv" translate="label" type="select" sortOrder="45" showInDefault="1" showInWebsite="1" showInStore="0">
                    <label>Show Credit Card Verification Field</label>
                    <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
                    <comment>Show field for CVV2 (3/4 digit) field</comment>
                </field>-->
                <field id="allowspecific" translate="label" type="allowspecific" sortOrder="50" showInDefault="1" showInWebsite="1" showInStore="0">
                    <label>Payment from Applicable Countries</label>
                    <source_model>Magento\Payment\Model\Config\Source\Allspecificcountries</source_model>
                </field>
                <field id="specificcountry" translate="label" type="multiselect" sortOrder="51" showInDefault="1" showInWebsite="1" showInStore="0">
                    <label>Payment from Specific Countries</label>
                    <source_model>Magento\Directory\Model\Config\Source\Country</source_model>
                    <can_be_empty>1</can_be_empty>
                </field>
                <field id="min_order_total" translate="label" type="text" sortOrder="98" showInDefault="1" showInWebsite="1" showInStore="0">
                    <label>Minimum Order Total</label>
                </field>
                <field id="max_order_total" translate="label" type="text" sortOrder="99" showInDefault="1" showInWebsite="1" showInStore="0">
                    <label>Maximum Order Total</label>
                </field>
                <field id="sort_order" translate="label" type="text" sortOrder="100" showInDefault="1" showInWebsite="1" showInStore="0">
                    <label>Sort Order</label>
                    <frontend_class>validate-number</frontend_class>
                </field>
                <field id="model"></field>
            </group>
        </section>
    </system>
</config>
<!--
/**
 * Product:       Xtento_SavedCc (1.0.6)
 * ID:            NZWbKguR/Yb8QYk68QaZWfj7V5pl/BlDdubJ/+3MKvg=
 * Packaged:      2018-08-15T13:47:06+00:00
 * Last Modified: 2017-11-08T12:36:53+00:00
 * File:          app/code/Xtento/SavedCc/etc/adminhtml/system.xml
 * Copyright:     Copyright (c) 2018 XTENTO GmbH & Co. KG <info@xtento.com> / All rights reserved.
 */
-->